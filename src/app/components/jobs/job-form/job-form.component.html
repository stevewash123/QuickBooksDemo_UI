<div class="job-form-container">
  <div class="header">
    <button class="btn btn-back" (click)="cancel()">‚Üê Cancel</button>
    <h2>{{ isEditing ? 'Edit Job' : 'Create New Job' }}</h2>
    <button class="btn btn-primary" (click)="onSubmit()" [disabled]="loading">
      {{ loading ? 'Saving...' : 'Save' }}
    </button>
  </div>

  <form class="job-form" [formGroup]="jobForm" (ngSubmit)="onSubmit()">
    <div class="form-section">
      <div class="form-group">
        <label for="customer">Customer: *</label>
        <select id="customer" formControlName="customerId" [class.error]="isFieldInvalid('customerId')" [disabled]="loadingCustomers">
          <option value="">{{ loadingCustomers ? 'Loading customers...' : 'Select Customer' }}</option>
          <option *ngFor="let customer of customers" [value]="customer.id">
            {{ customer.name }}
          </option>
        </select>
        <div class="error-message" *ngIf="getFieldError('customerId')">
          {{ getFieldError('customerId') }}
        </div>
      </div>

      <div class="form-group">
        <label for="jobType">Job Type: *</label>
        <select id="jobType" formControlName="jobType" [class.error]="isFieldInvalid('jobType')">
          <option [value]="0">Installation</option>
          <option [value]="1">Service Call</option>
          <option [value]="2">Repair</option>
        </select>
        <div class="error-message" *ngIf="getFieldError('jobType')">
          {{ getFieldError('jobType') }}
        </div>
      </div>

      <div class="form-group full-width">
        <label for="description">Description: *</label>
        <textarea
          id="description"
          formControlName="description"
          rows="3"
          placeholder="Enter job description..."
          [class.error]="isFieldInvalid('description')">
        </textarea>
        <div class="error-message" *ngIf="getFieldError('description')">
          {{ getFieldError('description') }}
        </div>
      </div>

      <div class="form-group">
        <label for="status">Initial Status:</label>
        <div class="radio-group">
          <label class="radio-label" [class.selected]="jobForm.get('status')?.value === 0">
            <input type="radio" formControlName="status" [value]="0">
            <span>üü° Quote</span>
          </label>
          <label class="radio-label" [class.selected]="jobForm.get('status')?.value === 1">
            <input type="radio" formControlName="status" [value]="1">
            <span>üîµ In Progress</span>
          </label>
        </div>
        <div class="error-message" *ngIf="getFieldError('status')">
          {{ getFieldError('status') }}
        </div>
      </div>

      <div class="optional-section">
        <h3>Optional</h3>

        <div class="form-group">
          <label for="technician">Assign Technician:</label>
          <select id="technician" formControlName="assignedTechnicianId" [disabled]="loadingTechnicians">
            <option value="">{{ loadingTechnicians ? 'Loading technicians...' : 'Select...' }}</option>
            <option *ngFor="let tech of technicians" [value]="tech.id">
              {{ tech.name }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="scheduledDate">Schedule Date:</label>
          <input
            type="date"
            id="scheduledDate"
            formControlName="scheduledDate">
        </div>

        <div class="form-group">
          <label for="quotedAmount">Estimated Amount:</label>
          <input
            type="number"
            id="quotedAmount"
            formControlName="quotedAmount"
            min="0"
            step="0.01"
            placeholder="0.00"
            [class.error]="isFieldInvalid('quotedAmount')">
          <div class="error-message" *ngIf="getFieldError('quotedAmount')">
            {{ getFieldError('quotedAmount') }}
          </div>
        </div>
      </div>
    </div>
  </form>
</div>